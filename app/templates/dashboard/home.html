{% extends "base.html" %}

{% block title %}Home - CommUnity{% endblock %}

{% block content %}
<div class="relative flex h-full w-full flex-col min-h-screen pb-24 bg-background-light dark:bg-background-dark overflow-hidden">
    <!-- TopAppBar -->
    <header class="sticky top-0 z-30 flex items-center bg-background-light/95 dark:bg-background-dark/95 backdrop-blur-md px-4 sm:px-6 lg:px-8 py-3 lg:py-4 justify-between border-b border-slate-200 dark:border-slate-800">
        <a href="{{ url_for('profile.view_profile') }}" class="flex items-center gap-3 lg:gap-4 hover:opacity-80 transition-opacity cursor-pointer">
            <div class="relative">
                <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10 lg:size-12 ring-2 ring-primary/20" style="background-image: url('{{ current_user.profile_picture or 'https://ui-avatars.com/api/?name=' + current_user.name + '&background=1392ec&color=fff' }}');"></div>
                <div class="absolute bottom-0 right-0 size-3 lg:size-3.5 bg-green-500 border-2 border-white dark:border-background-dark rounded-full"></div>
            </div>
            <div class="flex flex-col">
                <span class="text-slate-500 dark:text-slate-400 text-xs lg:text-sm font-semibold uppercase tracking-wider">Welcome back</span>
                <h2 class="text-slate-900 dark:text-white text-lg lg:text-xl font-bold leading-tight">{{ current_user.name.split()[0] }}</h2>
            </div>
        </a>
        <button class="relative flex size-10 lg:size-12 items-center justify-center rounded-full bg-white dark:bg-surface-dark border border-slate-100 dark:border-slate-700 shadow-sm active:scale-95 transition-transform">
            <span class="material-symbols-outlined text-slate-700 dark:text-slate-200" style="font-size: 24px;">notifications</span>
            <span class="absolute top-2 right-2 size-2 lg:size-2.5 bg-red-500 rounded-full animate-pulse"></span>
        </button>
    </header>
    
    <!-- SearchBar -->
    <div class="px-4 sm:px-6 lg:px-8 py-4 lg:py-5 sticky top-[68px] lg:top-[76px] z-20 bg-background-light dark:bg-background-dark">
        <div class="flex gap-2 lg:gap-3 w-full max-w-7xl mx-auto h-12 lg:h-14">
            <div class="flex w-full flex-1 items-center rounded-xl bg-white dark:bg-surface-dark shadow-sm border border-slate-100 dark:border-slate-700 overflow-hidden focus-within:ring-2 focus-within:ring-primary/50 transition-all">
                <div class="flex items-center justify-center pl-4 text-primary">
                    <span class="material-symbols-outlined" style="font-size: 24px;">search</span>
                </div>
                <input class="w-full bg-transparent border-none text-slate-900 dark:text-white placeholder:text-slate-400 dark:placeholder:text-slate-500 px-3 py-2 focus:ring-0 text-base lg:text-lg font-medium" placeholder="Search events, groups, issues..."/>
            </div>
            <button class="flex shrink-0 aspect-square h-full items-center justify-center rounded-xl bg-primary text-white shadow-md active:bg-primary/90 transition-colors">
                <span class="material-symbols-outlined" style="font-size: 24px;">tune</span>
            </button>
        </div>
    </div>

    
    <!-- Scrollable Content -->
    <div class="flex-1 overflow-y-auto">
        <!-- Quick Actions Grid -->
        <section class="px-4 sm:px-6 lg:px-8 pb-6 lg:pb-8 max-w-7xl mx-auto">
            <h3 class="sr-only">Quick Actions</h3>
            <div class="grid grid-cols-3 sm:grid-cols-3 md:grid-cols-6 lg:grid-cols-6 gap-3 md:gap-4 lg:gap-5">
                <a href="/issues/report" class="group flex flex-col items-center gap-2 lg:gap-3 p-3 lg:p-4 rounded-2xl bg-white dark:bg-surface-dark border border-slate-100 dark:border-slate-700 shadow-sm hover:shadow-md active:scale-95 transition-all">
                    <div class="flex items-center justify-center size-12 lg:size-14 rounded-full bg-red-50 dark:bg-red-900/20 text-red-500 dark:text-red-400 group-hover:bg-red-100 dark:group-hover:bg-red-900/30 transition-colors">
                        <span class="material-symbols-outlined" style="font-size: 28px;">campaign</span>
                    </div>
                    <span class="text-xs lg:text-sm font-bold text-slate-700 dark:text-slate-300 text-center leading-tight">Report<br/>Issue</span>
                </a>
                
                <a href="/events" class="group flex flex-col items-center gap-2 lg:gap-3 p-3 lg:p-4 rounded-2xl bg-white dark:bg-surface-dark border border-slate-100 dark:border-slate-700 shadow-sm hover:shadow-md active:scale-95 transition-all">
                    <div class="flex items-center justify-center size-12 lg:size-14 rounded-full bg-blue-50 dark:bg-blue-900/20 text-primary group-hover:bg-blue-100 dark:group-hover:bg-blue-900/30 transition-colors">
                        <span class="material-symbols-outlined" style="font-size: 28px;">calendar_month</span>
                    </div>
                    <span class="text-xs lg:text-sm font-bold text-slate-700 dark:text-slate-300 text-center leading-tight">Browse<br/>Events</span>
                </a>
                
                <a href="/groups" class="group flex flex-col items-center gap-2 lg:gap-3 p-3 lg:p-4 rounded-2xl bg-white dark:bg-surface-dark border border-slate-100 dark:border-slate-700 shadow-sm hover:shadow-md active:scale-95 transition-all">
                    <div class="flex items-center justify-center size-12 lg:size-14 rounded-full bg-emerald-50 dark:bg-emerald-900/20 text-emerald-600 dark:text-emerald-400 group-hover:bg-emerald-100 dark:group-hover:bg-emerald-900/30 transition-colors">
                        <span class="material-symbols-outlined" style="font-size: 28px;">diversity_3</span>
                    </div>
                    <span class="text-xs lg:text-sm font-bold text-slate-700 dark:text-slate-300 text-center leading-tight">Join<br/>Groups</span>
                </a>
            </div>
        </section>
        
        <!-- AI Powered Section -->
        <section class="pb-6 lg:pb-8">
            <div class="flex items-center justify-between px-4 sm:px-6 lg:px-8 pb-3 lg:pb-4 max-w-7xl mx-auto">
                <div class="flex items-center gap-2">
                    <h2 class="text-xl lg:text-2xl font-bold text-slate-900 dark:text-white">For You</h2>
                    <span class="inline-flex items-center rounded-full bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 px-2 py-0.5 text-[10px] font-bold text-white shadow-sm">
                        <span class="material-symbols-outlined mr-1" style="font-size: 12px;">auto_awesome</span>
                        AI
                    </span>
                </div>
                <a class="text-sm font-semibold text-primary hover:text-primary/80" href="/events">See all</a>
            </div>
            <div class="flex gap-4 overflow-x-auto px-4 sm:px-6 lg:px-8 pb-4 hide-scrollbar snap-x snap-mandatory max-w-7xl mx-auto">
                <!-- AI Card 1 -->
                <div class="snap-center shrink-0 w-72 sm:w-80 md:w-96 lg:w-[420px] rounded-2xl lg:rounded-3xl bg-white dark:bg-surface-dark border border-slate-100 dark:border-slate-700 shadow-md overflow-hidden group cursor-pointer">
                    <div class="relative h-32 lg:h-48 w-full overflow-hidden">
                        <div class="absolute inset-0 bg-cover bg-center transition-transform group-hover:scale-105" style="background-image: url('https://images.unsplash.com/photo-1540575467063-178a50c2df87?w=800');"></div>
                        <div class="absolute top-3 left-3 bg-white/90 dark:bg-black/80 backdrop-blur-sm px-2 py-1 rounded-md text-xs font-bold text-slate-900 dark:text-white">
                            Tech Event
                        </div>
                    </div>
                    <div class="p-4 lg:p-5">
                        <h3 class="text-base lg:text-lg font-bold text-slate-900 dark:text-white line-clamp-1">Downtown Tech Meetup</h3>
                        <p class="mt-1 text-sm lg:text-base text-slate-500 dark:text-slate-400 line-clamp-2">Connect with local developers and designers. Free pizza included!</p>
                        <div class="mt-3 flex items-center justify-between">
                            <span class="text-xs font-medium text-slate-400 flex items-center gap-1">
                                <span class="material-symbols-outlined" style="font-size: 14px;">schedule</span> Tomorrow, 6PM
                            </span>
                            <span class="size-6 flex items-center justify-center rounded-full bg-primary/10 text-primary">
                                <span class="material-symbols-outlined" style="font-size: 16px;">arrow_forward</span>
                            </span>
                        </div>
                    </div>
                </div>
                
                <!-- AI Card 2 -->
                <div class="snap-center shrink-0 w-72 sm:w-80 md:w-96 lg:w-[420px] rounded-2xl lg:rounded-3xl bg-white dark:bg-surface-dark border border-slate-100 dark:border-slate-700 shadow-md overflow-hidden group cursor-pointer">
                    <div class="relative h-32 lg:h-48 w-full overflow-hidden">
                        <div class="absolute inset-0 bg-cover bg-center transition-transform group-hover:scale-105" style="background-image: url('https://images.unsplash.com/photo-1559027615-cd4628902d4a?w=800');"></div>
                        <div class="absolute top-3 left-3 bg-white/90 dark:bg-black/80 backdrop-blur-sm px-2 py-1 rounded-md text-xs font-bold text-slate-900 dark:text-white">
                            Group
                        </div>
                    </div>
                    <div class="p-4 lg:p-5">
                        <h3 class="text-base lg:text-lg font-bold text-slate-900 dark:text-white line-clamp-1">Community Clean Up</h3>
                        <p class="mt-1 text-sm lg:text-base text-slate-500 dark:text-slate-400 line-clamp-2">Join 45 neighbors making our streets cleaner and safer.</p>
                        <div class="mt-3 flex items-center justify-between">
                            <div class="flex -space-x-2">
                                <img alt="Member" class="inline-block size-6 rounded-full ring-2 ring-white dark:ring-surface-dark" src="https://ui-avatars.com/api/?name=User+1&background=1392ec&color=fff"/>
                                <img alt="Member" class="inline-block size-6 rounded-full ring-2 ring-white dark:ring-surface-dark" src="https://ui-avatars.com/api/?name=User+2&background=ec1313&color=fff"/>
                                <span class="flex items-center justify-center size-6 rounded-full ring-2 ring-white dark:ring-surface-dark bg-slate-100 text-[10px] font-bold text-slate-600">+12</span>
                            </div>
                            <span class="size-6 flex items-center justify-center rounded-full bg-primary/10 text-primary">
                                <span class="material-symbols-outlined" style="font-size: 16px;">add</span>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Main Feed -->
        <section class="px-4 sm:px-6 lg:px-8 pb-4 lg:pb-8 max-w-7xl mx-auto">
            <h2 class="text-xl lg:text-2xl font-bold text-slate-900 dark:text-white mb-4 lg:mb-6">Happening Nearby</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 lg:gap-6">
                <!-- Feed Item 1: Issue -->
                <article class="bg-white dark:bg-surface-dark p-4 lg:p-5 rounded-2xl lg:rounded-3xl border border-slate-100 dark:border-slate-700 shadow-sm hover:shadow-md transition-shadow">
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex items-center gap-3">
                            <div class="size-10 rounded-full bg-slate-100 dark:bg-slate-700 flex items-center justify-center text-slate-500 dark:text-slate-400">
                                <span class="material-symbols-outlined">person</span>
                            </div>
                            <div>
                                <p class="text-sm font-bold text-slate-900 dark:text-white">Sarah Jenkins</p>
                                <p class="text-xs text-slate-500">Reported an issue • 2h ago</p>
                            </div>
                        </div>
                        <span class="bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400 px-2 py-1 rounded-md text-[10px] font-bold uppercase tracking-wide">Pending</span>
                    </div>
                    <h3 class="text-base lg:text-lg font-bold text-slate-900 dark:text-white mb-1">Streetlight out on 5th Ave</h3>
                    <p class="text-sm lg:text-base text-slate-600 dark:text-slate-300 mb-3">The streetlight at the corner of 5th and Main has been flickering for days and is now completely dark. It's unsafe for pedestrians.</p>
                    <div class="w-full h-48 lg:h-56 rounded-lg lg:rounded-xl bg-slate-200 dark:bg-slate-800 mb-3 overflow-hidden">
                        <div class="w-full h-full bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1532996122724-e3c354a0b15b?w=800');"></div>
                    </div>
                    <div class="flex items-center gap-4 border-t border-slate-100 dark:border-slate-700 pt-3">
                        <button class="flex items-center gap-1.5 text-sm text-slate-500 hover:text-primary transition-colors">
                            <span class="material-symbols-outlined" style="font-size: 20px;">thumb_up</span>
                            <span>24 Supports</span>
                        </button>
                        <button class="flex items-center gap-1.5 text-sm text-slate-500 hover:text-primary transition-colors">
                            <span class="material-symbols-outlined" style="font-size: 20px;">chat_bubble</span>
                            <span>8 Comments</span>
                        </button>
                    </div>
                </article>
                
                <!-- Feed Item 2: Event -->
                <article class="bg-white dark:bg-surface-dark p-4 rounded-2xl border border-slate-100 dark:border-slate-700 shadow-sm">
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex items-center gap-3">
                            <div class="size-10 rounded-full bg-primary/10 flex items-center justify-center text-primary">
                                <span class="material-symbols-outlined">spa</span>
                            </div>
                            <div>
                                <p class="text-sm font-bold text-slate-900 dark:text-white">City Yoga Club</p>
                                <p class="text-xs text-slate-500">New Event • 5h ago</p>
                            </div>
                        </div>
                    </div>
                    <div class="flex gap-4">
                        <div class="flex-col items-center justify-center shrink-0 w-14 h-16 bg-slate-100 dark:bg-slate-800 rounded-lg flex border border-slate-200 dark:border-slate-600">
                            <span class="text-xs font-bold text-red-500 uppercase">Jan</span>
                            <span class="text-xl font-bold text-slate-900 dark:text-white">15</span>
                        </div>
                        <div>
                            <h3 class="text-base font-bold text-slate-900 dark:text-white">Morning Sun Salutation</h3>
                            <p class="text-sm text-slate-600 dark:text-slate-300">Central Park • 7:00 AM</p>
                            <div class="flex -space-x-2 mt-2">
                                <img alt="Attendee" class="inline-block size-6 rounded-full ring-2 ring-white dark:ring-surface-dark" src="https://ui-avatars.com/api/?name=Person+1&background=1392ec&color=fff"/>
                                <img alt="Attendee" class="inline-block size-6 rounded-full ring-2 ring-white dark:ring-surface-dark" src="https://ui-avatars.com/api/?name=Person+2&background=ec8113&color=fff"/>
                                <img alt="Attendee" class="inline-block size-6 rounded-full ring-2 ring-white dark:ring-surface-dark" src="https://ui-avatars.com/api/?name=Person+3&background=13ec3e&color=fff"/>
                                <span class="flex items-center justify-center px-2 h-6 rounded-full ring-2 ring-white dark:ring-surface-dark bg-slate-100 text-[10px] font-bold text-slate-600">+42 attending</span>
                            </div>
                        </div>
                    </div>
                    <button class="w-full mt-4 py-2 bg-primary/10 hover:bg-primary/20 text-primary font-bold text-sm rounded-lg transition-colors">
                        RSVP Now
                    </button>
                </article>
            </div>
        </section>
    </div>
    
    <!-- Bottom Navigation -->
    <nav class="fixed bottom-0 z-40 w-full bg-white/90 dark:bg-surface-dark/90 backdrop-blur-lg border-t border-slate-200 dark:border-slate-800 pb-safe">
        <div class="flex items-center justify-around h-16 lg:h-20 px-2 lg:px-4 max-w-7xl mx-auto">
            <a href="/dashboard" class="flex flex-col items-center justify-center w-full h-full gap-1 text-primary">
                <span class="material-symbols-outlined filled text-2xl lg:text-3xl" style="font-variation-settings: 'FILL' 1;">home</span>
                <span class="text-[10px] lg:text-xs font-bold">Home</span>
            </a>
            <a href="/events" class="flex flex-col items-center justify-center w-full h-full gap-1 text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300">
                <span class="material-symbols-outlined text-2xl lg:text-3xl">explore</span>
                <span class="text-[10px] lg:text-xs font-medium">Explore</span>
            </a>
            <a href="/chat" class="flex flex-col items-center justify-center w-full h-full gap-1 text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300">
                <div class="relative">
                    <span class="material-symbols-outlined text-2xl lg:text-3xl">chat</span>
                    <span class="absolute -top-1 -right-1 size-2.5 bg-red-500 rounded-full border-2 border-white dark:border-surface-dark"></span>
                </div>
                <span class="text-[10px] lg:text-xs font-medium">Chat</span>
            </a>
            <a href="{{ url_for('profile.view_profile') }}" class="flex flex-col items-center justify-center w-full h-full gap-1 text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300">
                <span class="material-symbols-outlined text-2xl lg:text-3xl">person</span>
                <span class="text-[10px] lg:text-xs font-medium">Profile</span>
            </a>
            <a href="/auth/logout" class="flex flex-col items-center justify-center w-full h-full gap-1 text-slate-400 dark:text-slate-500 hover:text-red-500 dark:hover:text-red-400 transition-colors">
                <span class="material-symbols-outlined text-2xl lg:text-3xl">logout</span>
                <span class="text-[10px] lg:text-xs font-medium">Logout</span>
            </a>
        </div>
    </nav>
</div>
{% endblock %}